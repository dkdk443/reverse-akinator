# 逆アキネーター プロジェクト設計書

## プロジェクト概要

### コンセプト
ユーザーが有名な歴史上の人物を思い浮かべ、システム(AI)に質問を投げかける。AIがその質問に「はい」「いいえ」「どちらとも言えない」で回答し、ユーザーが推理して人物を当てるゲーム。

### 特徴
- 本家Akinatorとは逆: 人間が質問し、AIが答える
- プロトタイプは30人の歴史上の人物で実装
- コストを最小限に抑えた構成

---

## UX設計

### 画面遷移

#### 1. スタート画面
- 表示内容: 「有名な人物を思い浮かべました。誰か当ててね」
- アクション: スタートボタン

#### 2. 質問画面(メイン)
- カテゴリ別の質問選択肢
  - 📅 年代
  - 🌍 地域
  - 👤 性別
  - 🎂 年齢
  - 💼 職業
  - ✨ 特徴
- フリー入力欄(将来的な拡張)
- AIの回答表示: 「はい」「いいえ」「どちらとも言えない」
- 質問履歴の表示

#### 3. 回答画面
- ユーザーが人物名を入力
- 「この人ですか?」確認

#### 4. 結果画面
- 正解: 「正解です!〇問で当てました」
- 不正解: 「残念!正解は〇〇でした」

---

## 技術スタック

### フロントエンド・バックエンド
- **Next.js 14** (App Router)
- **TypeScript**
- **Tailwind CSS** (スタイリング)

### データベース
- **SQLite** (better-sqlite3)
- ファイルベース、完全無料
- リポジトリに同梱

### デプロイ
- **Vercel** 無料枠

### コスト
- **総コスト: 0円**

---

## プロジェクト構成

```
reverse-akinator/
├─ app/
│  ├─ page.tsx              # スタート画面
│  ├─ game/
│  │  └─ page.tsx           # ゲーム画面
│  └─ api/
│     ├─ start/route.ts     # ゲーム開始(ランダム人物選択)
│     ├─ answer/route.ts    # 質問に回答
│     └─ guess/route.ts     # 正誤判定
├─ lib/
│  └─ db.ts                 # SQLite接続・クエリ
├─ data/
│  └─ persons.db            # SQLiteファイル
└─ types/
   └─ index.ts              # 型定義
```

---

## データベース設計

### テーブル構成

#### persons (人物マスタ)
```sql
CREATE TABLE persons (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name VARCHAR(100) NOT NULL,
  name_en VARCHAR(100),
  description TEXT,
  image_url VARCHAR(255)
);
```

#### attributes (属性マスタ)
```sql
CREATE TABLE attributes (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  category VARCHAR(50) NOT NULL,  -- 'era', 'region', 'gender', 'age', 'occupation', 'trait'
  question TEXT NOT NULL,          -- 「戦国時代の人ですか?」
  attribute_key VARCHAR(50) NOT NULL UNIQUE
);
```

#### person_attributes (人物と属性の紐付け)
```sql
CREATE TABLE person_attributes (
  person_id INTEGER NOT NULL,
  attribute_id INTEGER NOT NULL,
  value BOOLEAN NOT NULL,  -- YES/NO
  PRIMARY KEY (person_id, attribute_id),
  FOREIGN KEY (person_id) REFERENCES persons(id),
  FOREIGN KEY (attribute_id) REFERENCES attributes(id)
);
```

#### game_sessions (ゲームセッション - 統計用)
```sql
CREATE TABLE game_sessions (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  person_id INTEGER NOT NULL,
  question_count INTEGER,
  is_correct BOOLEAN,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (person_id) REFERENCES persons(id)
);
```

---

## 質問カテゴリと属性例

### 📅 年代 (era)
- 古代の人ですか?
- 中世の人ですか?
- 近世の人ですか?
- 近代の人ですか?
- 現代の人ですか?

### 🌍 地域 (region)
- 日本人ですか?
- 中国人ですか?
- ヨーロッパの人ですか?
- アメリカの人ですか?
- その他のアジアの人ですか?

### 👤 性別 (gender)
- 男性ですか?
- 女性ですか?

### 🎂 年齢 (age)
- 若くして亡くなりましたか?
- 長生きしましたか?

### 💼 職業 (occupation)
- 政治家ですか?
- 軍人・武将ですか?
- 芸術家ですか?
- 科学者ですか?
- 作家ですか?
- 音楽家ですか?
- 思想家・宗教家ですか?

### ✨ 特徴 (trait)
- 戦いに関わりましたか?
- 革命を起こしましたか?
- 作品を残しましたか?
- ノーベル賞を受賞しましたか?

---

## プロトタイプ対象人物リスト (30人)

### 日本史 (15人)
1. 織田信長 - 戦国時代・武将
2. 豊臣秀吉 - 戦国時代・武将
3. 徳川家康 - 江戸時代・将軍
4. 坂本龍馬 - 幕末・志士
5. 西郷隆盛 - 明治時代・軍人
6. 夏目漱石 - 近代・作家
7. 樋口一葉 - 近代・作家・女性
8. 野口英世 - 近代・科学者
9. 紫式部 - 平安時代・作家・女性
10. 聖徳太子 - 飛鳥時代・政治家
11. 源義経 - 平安時代末期・武将
12. 葛飾北斎 - 江戸時代・芸術家
13. 伊藤博文 - 明治時代・政治家
14. 福沢諭吉 - 明治時代・思想家
15. 手塚治虫 - 現代・漫画家

### 世界史 (15人)
16. ナポレオン・ボナパルト - 近代・軍人・フランス
17. クレオパトラ7世 - 古代・女王・エジプト
18. レオナルド・ダ・ヴィンチ - ルネサンス・芸術家・イタリア
19. ヴォルフガング・アマデウス・モーツァルト - 近世・音楽家・オーストリア
20. アルベルト・アインシュタイン - 現代・科学者・ドイツ系
21. マリー・キュリー - 近代・科学者・女性・ポーランド
22. マハトマ・ガンディー - 現代・政治家・インド
23. マザー・テレサ - 現代・宗教家・女性
24. ウィリアム・シェイクスピア - 近世・作家・イギリス
25. ルートヴィヒ・ヴァン・ベートーヴェン - 近代・音楽家・ドイツ
26. パブロ・ピカソ - 現代・芸術家・スペイン
27. チャールズ・チャップリン - 現代・俳優・イギリス
28. エイブラハム・リンカーン - 近代・政治家・アメリカ
29. ジョン・F・ケネディ - 現代・政治家・アメリカ
30. チンギス・ハン - 中世・軍人・モンゴル

---

## API設計

### POST /api/start
ゲーム開始。ランダムに人物を選択し、セッションIDを返す。

**Response:**
```json
{
  "sessionId": "abc123",
  "message": "有名な人物を思い浮かべました。質問してください!"
}
```

### POST /api/answer
質問に対してAIが回答。

**Request:**
```json
{
  "sessionId": "abc123",
  "attributeId": 5
}
```

**Response:**
```json
{
  "answer": "はい" | "いいえ" | "どちらとも言えない",
  "questionCount": 3
}
```

### POST /api/guess
ユーザーの推測を判定。

**Request:**
```json
{
  "sessionId": "abc123",
  "guessedPersonId": 1
}
```

**Response:**
```json
{
  "isCorrect": true,
  "correctPerson": {
    "id": 1,
    "name": "織田信長",
    "description": "戦国時代の武将"
  },
  "questionCount": 5
}
```

---

## 次のステップ

1. ✅ プロジェクト設計完了
2. ⬜ Next.jsプロジェクト作成
3. ⬜ SQLiteデータベース作成・初期データ投入
4. ⬜ API実装
5. ⬜ UI実装
6. ⬜ デプロイ

---

## 将来的な拡張機能

- フリー入力質問の自然言語処理
- 人物数の拡大(100人、1000人...)
- 質問履歴の最適化(機械学習)
- マルチプレイヤー対応
- ランキング機能